(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{454:function(e,t,r){"use strict";r.r(t);var n=r(62),a=(r(117),r(11),r(182),r(115),r(13),r(14),r(53),r(16)),o={name:"XRequest",props:{mode:{type:String,default:"parallel"},params:[Object,Array],preprocessor:{type:Function,default:function(){return!0}},processor:{type:Function,default:function(e){return e}},service:[Function,Array],component:{type:[String,Object],default:"div"},poll:[Boolean,Object],paramResolver:Function},data:function(){return{loading:!1,error:!1,data:null,errormessage:null}},watch:{poll:function(e){!e&&this.currtimeout?clearTimeout(this.currtimeout):this.request()}},created:function(){this.request()},mounted:function(){var e=this;this.$watch((function(){return e.params}),(function(t,r){JSON.stringify(t)!==JSON.stringify(r)&&e.request()}),{deep:!0})},destroyed:function(){this.currtimeout&&clearTimeout(this.currtimeout)},methods:{resetData:function(){this.data=null},request:function(e){var t=this;if(this.preprocessor()){e||(this.loading=!0),this.error=!1,this.errormessage=null;var r,n=this.service;if(Array.isArray(this.params)?("parallel"===this.mode&&(r=this.parallelReq()),"waterfall"===this.mode&&(r=this.waterfallReq())):r=n(this.params).then((function(e){t.data=t.processor(e)})).catch((function(e){console.log(e),t.errormessage=e,t.error=!0})).finally((function(){t.loading=!1})),this.currentRequest=r,this.poll){var a=this.poll.interval;this.currtimeout&&clearTimeout(this.currtimeout),this.currtimeout=setTimeout((function(){t.request()}),a)}return this.currentRequest}},parallelReq:function(){var e=this,t=this.service;return Promise.all(this.params.map((function(e){return t(e).catch((function(e){return console.log(e),[]}))}))).then((function(t){e.data=e.processor(t)})).catch((function(t){e.errormessage=t,e.error=!0})).finally((function(){e.loading=!1}))},waterfallReq:function(){var e,t,r=this,n=this.service,o=this.paramResolver,i=0,s=[],u={},c=this.params[i],l=null,f=null,m=new Promise((function(r,n){e=r,t=n}));return function c(m){var h=o(m,l,f,u,i);(Object(a.isFunction)(n)?n:n[i])(h).then((function(t){if(s.push({currParam:m,result:t}),i+=1,l=m,f=t,!(m=r.params[i]))return r.data=s,r.loading=!1,void e();c(m)})).catch((function(e){r.errormessage=e,r.error=!0,t()}))}(c),m}}},i=r(10),s=Object(i.a)(o,(function(){var e=this.$createElement;return(this._self._c||e)(this.component,{tag:"component"},[this._t("default",null,{data:this.data,error:this.error,loading:this.loading,errormessage:this.errormessage})],2)}),[],!1,null,null,null).exports,u=function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,r){setTimeout((function(){var n=t.a+t.b;n>40?e(n):r(n)}),2e3)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c={components:{xRequest:s},data:function(){return{a:"20",b:"40",service:u}},computed:{requestParam:function(){return{a:+this.a,b:+this.b}}},methods:{resolver:function(e){return console.log(e),e},refresh:function(){this.$refs.request.request()}}},l=Object(i.a)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("input",{directives:[{name:"model",rawName:"v-model",value:e.a,expression:"a"}],domProps:{value:e.a},on:{input:function(t){t.target.composing||(e.a=t.target.value)}}}),e._v(" + \n    "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.b,expression:"b"}],domProps:{value:e.b},on:{input:function(t){t.target.composing||(e.b=t.target.value)}}}),e._v(" > 40\n    "),r("button",{on:{click:e.refresh}},[e._v("refresh")]),e._v(" "),r("x-request",{ref:"request",attrs:{service:e.service,params:e.requestParam,processor:e.resolver},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.data,a=t.loading,o=t.error;return[r("demo-visualize-data",{attrs:{value:{a:e.a,b:e.b,loading:a,data:n,error:o}}})]}}])})],1)}),[],!1,null,null,null);t.default=l.exports}}]);